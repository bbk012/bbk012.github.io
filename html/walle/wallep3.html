<!DOCTYPE html>
<!--Copyright (c) 2019 Bogdan Kowalczyk - MIT License. Uses free template from: https://www.w3schools.com/w3css/w3css_templates.asp -->
<!-- About Page -->
<html lang="en">
<title>Wall-e Robot Details Page 3</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Wall-e Robot Details Page 3">
<meta name="keywords" content="Robot,Software,Embedded Systems,Electronics">
<meta name="author" content="Bogdan Kowalczyk">
<!-- temporary excluded by B.K.
<link rel="stylesheet" href="https://www.w3schools.com/w3css/css/w3.css">
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
-->
<link rel="stylesheet" href="../../css/w3.css">
<link rel="stylesheet" href="../../css/w3-theme-black.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' 
integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
</style>


<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
    <a href="../../index.html" class="w3-bar-item w3-button w3-theme-l1" title="Home"> <i class="fas fa-robot" style="font-size:24px"></i> BBK</a>
    <a href="../about.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">About</a>
    <a href="../projects.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Projects</a>
    <a href="../links.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Links</a>
    <a href="../news.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">News</a>
    <a href="../contact.html" class="w3-bar-item w3-button w3-hide-small w3-hide-medium w3-hover-white">Contact</a>
  </div>
</div>

<!-- Sidebar -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-large w3-theme-l5 w3-animate-left" id="mySidebar">
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-xlarge w3-padding-large w3-hover-black w3-hide-large" title="Close Menu">
    <i class="fa fa-remove"></i>
  </a>
  <h4 class="w3-bar-item"><b>Menu</b></h4>
  <a class="w3-bar-item w3-button w3-hover-black" href="../../index.html">Home</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="../about.html">About</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="../projects.html">Projects</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="../links.html">Links</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="../news.html">News</a>
  <a class="w3-bar-item w3-button w3-hover-black" href="../contact.html">Contact</a>
</nav>

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidebar is visible -->
<div class="w3-main" style="margin-left:250px">
    <!-- Empty padding to better arrange topics-->
    <div class="w3-row w3-padding-large">  
    </div>

    <div class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
            <h1 class="w3-text-teal">WALLÂ·E Inspired Robot Project<br> (Page 3 of 3) </h1>
            <p>Here there are some additional Wall-e details presented including hardware block diagram and software architecture overview.
            </p>
        </div>
    </div>
 
    <div id="H1" class="w3-container">
        <h1 class="w3-text-teal">Wall-e Front and Back View</h1>
    </div>

    <div class="w3-row-padding w3-margin-top">
        <div class="w3-half">
            <div class="w3-card">
                <img src="../../img/walle/hwdescriptionfv.jpeg" style="width:100%">
                <div class="w3-container">
                    <h5>Wall-e Front View</h5>
                </div>
            </div>
        </div>
      
        <div class="w3-half">
            <div class="w3-card">
                <img src="../../img/walle/hwdescriptionrv.jpeg" style="width:100%">
                <div class="w3-container">
                    <h5>Wall-e Back View</h5>
                </div>
            </div>
        </div>
    </div>
    
    <div id="H2" class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
            <h1   class="w3-text-teal">Block Diagram</h1> </a>
            <p> This is hand made Wall-e Block Diagram. I will keep it here until I manage to rewrite it with a computer tool.
                It shows key Wall-e's components and how they functionally interact with the LPC2378 micro-controller (uC).
            </p>
        </div>

        <div class="w3-third w3-container">
            <a href="../../img/walle/blockdiag.jpg" target="_blank">
                <img src="../../img/walle/blockdiag.jpg" alt="Wall-e Block Diagram" style="width:100%;max-width:300px">
            </a>
            <a href="../../img/walle/blockdiag.jpg" target="_blank">
                <p class="w3-tiny"> Wall-e Block Diagram</p>
            </a>      
        </div>
    </div>

    <div class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
            <h3 class="w3-text-teal">Block Diagram Description</h3>
            <p> LPC2378 uC is a heart of the system. It controls all the peripherals which are either on the OLIMEX LPC2378-STK development board
            or on the additional self developed interface boards. There are 3 different NiNH battery packs which power the system one which is used to power
            motors, another one which is used to power servos and the third one which provides power to all electronics. PVG612 ICs (solid state relays) are used 
            to turn on and off power supply. This way LPC2378 uC has full power supply control and even can turn off and back turn on itself through its RTC Alarm output
            (as long as RTC battery is working). OLIMEX LPC2378-STK keypad (two buttons and joystick) is used to control LCD screen. Red LED on the STK board 
            is used as a heart bit indicator. MMA7260Q accelerometer which is available on the STK board is used as tilt detector to stop Wall-e when it starts to climb on obstacles.
            Left and right track motors are controlled by L298 IC motor driver. LPC2378 uC can control motor speed (PWM signal) as well as rotation direction (very standard L298 application).
            PVG612 IC is used to enable/disable motors' power. Because there is not encoder in the Tri-Track Chassis Kit I mounted internally a Transmissive Optical Sensor
            for both left and right track which counts track sprocket tooths passing through it. Powering of those sensors is also controlled (turned on or off) by uC.
            Dynamic buzzer KPX 612 05B is used to generate call signals. LPC2378 uC PWM outputs control head as well as left and right arm servos. Servos power supply
            same like in the case of other subsystem is fully controlled using solid state relay PVG612 ICs.
            8-channels Analog to Digital (A/D) converter MCP3208 on the main interface board is used to monitor every battery pack voltage level
            as well as to condition Angular Rate Sensor (ARS) EWTS62NB, front light phototransistor and day-light back photoresistor sensors. 
            Infrared distance detector GP2D12 is also connected to this A/D converter and its power supply is fully controlled by the uC.
            HC-SR04 Ultrasonic (US) distance detector is connected to uC ports directly. EasyVR 3 the multi-purpose speech recognition module is connected to one of the LPC2378
            serial links. There is also another serial link used for remote RS-232 serial interface.  
            </p>
        </div>
    </div>

    <div id="H3" class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
          <h1   class="w3-text-teal">Software</h1> </a>
          <p> This is Wall-e Software Architecture Diagram described in more details below.</p>
        </div>

        <div class="w3-third w3-container">
            <a href="../../img/walle/softwarediag.jpg" target="_blank">
                <img src="../../img/walle/softwarediag.jpg" alt="Software Architecture Diagram" style="width:100%;max-width:300px">
            </a>
            <a href="../../img/walle/softwarediag.jpg" target="_blank">
                <p class="w3-tiny"> Software Architecture Diagram</p>
            </a>      
        </div>
    </div>

    <div class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
          <h3 class="w3-text-teal">Software Architecture Description</h3>
          <p> 
              Wall-e software has layer architecture. Source code file names have prefix corresponding to the particular layer to simplify code navigation.
              For example all operating system files both *.c and *.h have os_ prefix.
              The lowest layer is the one which is directly dealing with hardware denoted with hw_ prefix. Its functions directly manipulate particular hardware components.
              Upon that layer there is control layer denoted ctr_ which provides more abstract level access to the underlying devices.
              Operating system layer marked os_ provides all uC/OS-II real time kernel services like tasks, mutexes, queues etc.
              In order to use object oriented programming (OOP) there is additional C++ based wrapper created. In this way real time kernel services are made
              available through OOP mechanisms like inheritance etc. Because in the system there are some supportive real time tasks (which are not abstracted
              to the managers level) tsk_ layer is used to cover this. The key Wall-e real time communication and multitasking management is realized using
              publish/subscribe concept. This paradigm is implemented through publish subscribe middleware (denoted mw_) and managers (denoted mng_).
              In the publish/subscribe paradigm communicating entities are loosely coupled. Publishers do not know their subscribers they publish a notifier
              (message) which can be consume by none or many subscribers. This creates a lot of flexibility - adding additional subscriber for a particular
              notifier does not introduce any modification in the code of existing publishers and subscribers.
              In Wall-e system the highest level in the software are managers (independent tasks) which can be either a publisher or a subscriber or both.
              Managers are denoted with mng_ prefix. Notifier Dispatcher is driven by the highest priority tasks. It checks every publisher for any published notifier
              and delivers it to all its subscribers. Subscribing can be dynamic at any moment subscriber can unsubscribe to receive any particular notifier.
              Notifiers are dynamically allocated on the heap, and reference count is used to keep them available as long as they are referenced.
              Publish/subscribe middleware is implemented using C++ templates. Because in the system standard C and C++ libraries are not used 
              (because of their size but also to have full control upon some functions like malloc, free etc.) there is system level
              library denoted lib_ which contains functions used by all other software components.  
          </p>
        </div>
    </div>

    <div id="H4" class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
            <h3   class="w3-text-teal">Obstacle Avoidance and Path Planning</h3>
            <p> Wall-e is using 2-dimensional (2D) occupancy grid 3 x 3 cells wide for its obstacle avoidance (cell dimension is 30[cm] x 30[cm]).
                    Whenever Wall-e detects an obstacle on its way either through infrared distance detector GP2D12 or using ultrasonic distance detector HC-SR04 or both
                    it stops, scans surroundings, assigns obstacles to the occupancy cells and next determine path forward the closest one to its current move direction.
                    This simple (naive) way it founds a path between obstacles following sense-plan-act paradigm. When two equal paths are determined, like on the picture, 
                    one is selected using random number generator.
            </p>
        </div>
        <div class="w3-third w3-container">
            <a href="../../img/walle/occupancygrid.jpg" target="_blank">
                <img src="../../img/walle/occupancygrid.jpg" alt="Occupancy Grid Picture" style="width:100%;max-width:300px">
            </a>
            <a href="../../img/walle/occupancygrid.jpg" target="_blank">
                <p class="w3-tiny"> Occupancy Grid</p>
            </a>      
        </div>
    </div>

    <div id="H5" class="w3-row w3-padding-16">
        <div class="w3-twothird w3-container">
            <h3 class="w3-text-teal">Wall-e Programs</h3>
            <p> Currently Wall-e is implementing 3 simple programs. Two of them named 'Test' and 'Enjoy' are implemented using Wall-e Simple Sequencer.
                    This sequencer is a kind of very primitive interpreter but allows to assembly simple move sequencies without the need of C/C++ programming.
                    I think better would be to port any simple interpreter like TCL or FORTH. 
                    I considered <a href="https://github.com/zserge/partcl">ParTcl</a> a simple TCL interpreter by Serge Zaitsev
                    but finally stayed with something even simpler. In the future however (having a bit more time) would be good to have something better embedded in the robot
                    for its more flexible and easier/quicker programming.
            </p>
            <p>
                    The third program 'Bath' is the main one implemented in C++. This is a state machine which executes 'get my wife out of the bath' program.
                    It wakes-up Wall-e at nights who then checks if there is night indeed and scans surroundings to determine a light source 
                    (which he assumes is the one from the bath) and starts moving towards it. If on its way to the bath Wall-e encounters any obstacles, he makes attempts
                    to bypass them. When finally there is not possibility to move he assumes bath doors are there so he starts the call signal. After couple of call signals 
                    issued Wall-e moves aside (to avoid hitting by the opened door) and goes to sleep. This program <a href="https://youtu.be/0yo_ZbzMGnw">demo</a> you can find on the 
                    YouTube as well as <a href="https://youtu.be/vpOA1GR5Tuw">the one</a> which demonstrates voice control of the robot.
            </p>
        </div>

        <div class="w3-third w3-container">
            <a href="https://youtu.be/0yo_ZbzMGnw">
                <img src="../../img/walle/mywalle.jpg" alt="My Wall-e bath program video from the YouTube" style="width:100%;max-width:100px">
            </a>
            <a href="https://youtu.be/0yo_ZbzMGnw">
                <p class="w3-tiny"> <i class="fab fa-youtube"></i> "Bath" program demo</p>
            </a>
            <a href="https://youtu.be/vpOA1GR5Tuw">
                <img src="../../img/walle/walletalk.jpg" alt="My Wall-e talk video from the YouTube" style="width:100%;max-width:100px">
            </a>
            <a href="https://youtu.be/vpOA1GR5Tuw">
                <p class="w3-tiny"> <i class="fab fa-youtube"></i> Talk with Wall-e demo</p>
            </a>
        </div>
    </div>

    <!-- Pagination -->
    <div class="w3-center w3-padding-32">
        <div class="w3-bar">
            <a class="w3-button w3-hover-black" href="./wallep2.html"><<</a>
        </div>
    </div>

    <footer id="myFooter">
        <div class="w3-container w3-theme-l2 w3-padding-32">
            <h4><i class="far fa-copyright"></i> 2019 Bogdan Kowalczyk</h4>
        </div>

        <div class="w3-container w3-theme-l1">
            <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
            <div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" 		    title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" 		    title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a>
            </div>
        </div>
    </footer>

<!-- END MAIN -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>

</body>
</html>